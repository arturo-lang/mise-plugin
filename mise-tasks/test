#!/usr/bin/env bash
#MISE description="Run plugin tests - install and execute tool"
set -euo pipefail

mise plugin link --force arturo .
mise cache clear
mise install arturo@0.10.0

# Capture and display the output while also verifying it
output=$(mise exec "arturo@0.10.0" -- "arturo" --version)
echo "arturo output: $output"

if echo "$output" | grep -Eq '^arturo 0\.10\.0 Arizona Bark \((amd64|arm64)/(linux|macos|windows)\)$'; then
    echo "✓ Tests passed"
else
    echo "✗ Test failed: unexpected version string"
    exit 1
fi
